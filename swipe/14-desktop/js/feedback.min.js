!function(jQuery){jQuery.fn.feedbackSlider=function(options){var generateComment,controller,helper;options=jQuery.extend(!0,{wrapper:{block:"div",class:"comment item_%i"},photo:{block:"span",class:"photo"},text:{block:"p",class:"text"},stars:{block:"span",class:"stars"},name:{block:"p",class:"name"},town:{block:"p",class:"town"},elements:["photo","text","stars","name","town"],visibleItems:{desktop:4,miniTablet:2},container:{class:"comments_wp"},timer:500,globalTimer:15e3,timerBeforeStart:5e3,dimensions:{desktop:960,tablet:768,miniTablet:480}},options),generateComment={getPhoto:function(i){return jQuery("<"+options.photo.block+"/>",{class:options.photo.class,style:'background-image: url("'+this.getComment(i)+'")'}).addClass(this.getComment(i,"className",!1))},getComment:function(i,source,isSkinPath){return source=source||"bgSprite",isSkinPath="undefined"==typeof isSkinPath||isSkinPath,isSkinPath?skin_path+window.comments[i][source]:window.comments[i][source]},getWrapper:function(i){return jQuery("<"+options.wrapper.block+"/>",{class:options.wrapper.class.replace("%i",i)})},getText:function(i){return jQuery("<"+options.text.block+"/>",{class:options.text.class}).text(this.getComment(i,"text",!1))},getStars:function(i){var starsSpan=jQuery("<span/>",{class:"stars-name "+this.getComment(i,"className",!1),style:'background-image: url("'+this.getComment(i)+'")'});return jQuery("<"+options.stars.block+"/>",{class:options.stars.class}).append(starsSpan)},getName:function(i){var nameSpan=jQuery("<span/>",{class:"image-name "+this.getComment(i,"className",!1),style:'background-image: url("'+this.getComment(i)+'")'});return jQuery("<"+options.name.block+"/>",{class:options.name.class}).append(nameSpan)},getTown:function(i){return jQuery("<"+options.town.block+"/>",{class:options.town.class}).text(this.getComment(i,"town",!1))},getBlocks:function(iterator){for(var getFunction,arr=[],i=0;i<options.elements.length;i++)getFunction="this.get"+options.elements[i].capitalize()+"("+iterator+");",arr.push(eval(getFunction));return arr},generateFeedback:function(i){var result,elements=this.getBlocks(i);return result=this.getWrapper(i),result.append(elements)}},controller={run:function(){var me=this;this.widthBeforResize=viewPortWidth;var containerClass=options.container.class,container=jQuery("."+containerClass);container.empty();var result=[];this.device=helper.getDeviceType();for(var i=0;i<this.device.items;i++)result.push(generateComment.generateFeedback(i));container.attr("class",[containerClass,this.device.type].join(" ")).append(result),this.nextComment=this.device.items,this.currentPosition=0,me.initTimer=setTimeout(function(){controller.loop()},options.timerBeforeStart)},loop:function(){var comment=generateComment.getBlocks(this.nextComment),currentComment=jQuery("."+options.wrapper.class.replace("%i",String(this.currentPosition)).replace(" ",".")),me=this;currentComment.animate({opacity:0},options.timer,function(){currentComment.empty(),currentComment.append(comment),me.nextComment++,me.currentPosition++,currentComment.animate({opacity:1},options.timer,function(){me.nextComment==window.comments.length&&(me.nextComment=0),me.currentPosition==helper.getDeviceType().items?(me.currentPosition=0,me.resizeTimer=setTimeout(function(){me.loop()},options.globalTimer)):me.loop()})})}},helper={getDeviceType:function(){var result,viewPort=jQuery("html").width(),visibleItems=options.visibleItems;switch(!0){case viewPort<options.dimensions.miniTablet&&"undefined"!=typeof visibleItems.mobile:result={type:"mobile",items:visibleItems.mobile};break;case viewPort<options.dimensions.tablet&&"undefined"!=typeof visibleItems.miniTablet:result={type:"minitablet",items:visibleItems.miniTablet};break;case viewPort<options.dimensions.desktop&&"undefined"!=typeof visibleItems.tablet:result={type:"tablet",items:visibleItems.tablet};break;default:result={type:"desktop",items:visibleItems.desktop}}return result}},controller.run(),jQuery(window).resize(function(){var widthOnResize=jQuery("html").width();widthOnResize!=controller.widthBeforResize&&controller.device.type!=helper.getDeviceType().type&&(clearTimeout(controller.resizeTimer),clearTimeout(controller.initTimer),controller.run(),controller.widthBeforResize=widthOnResize)})}}(jQuery);