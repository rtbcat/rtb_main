!function($,window,document,undefined){"use strict";function Plugin(options,callbacks){this.opts=$.extend({},DEFAULTS,options),this.cb=$.extend({},CALLBACKS,callbacks),this.currentSection=0,this.windowHeight=window.innerHeight||document.documentElement.clientHeight,this.init()}var PLUGIN_NS="scrollSection",DEFAULTS={menuClass:"menu",dataAttr:"section",activeArea:150,activeClass:"active"},CALLBACKS={onInitBefore:function(){},onInitAfter:function(){}},getAllSections=function(){var _this=this;_this.sections=[],$("."+_this.opts.menuClass).find("[data-"+_this.opts.dataAttr+"]").each(function(){var el=$(this),refElement=$(el.data(_this.opts.dataAttr));_this.sections.push({section:refElement[0],menuItem:el[0],height:refElement.outerHeight(),offsetTop:refElement.offset().top,offsetBot:refElement.offset().top+refElement.outerHeight()})})},setCurrentSection=function(scrolltop){var ST,OT,OB,_this=this;_this.currentSection=undefined,ST=!isNaN(_this.opts.activeArea)&&_this.opts.activeArea>0?scrolltop+_this.opts.activeArea:scrolltop;for(var i=0,len=_this.sections.length;i<len;i++)OT=_this.sections[i].offsetTop,OB=_this.sections[i].offsetBot,ST>=OT&&ST<OB&&(_this.currentSection=i)},removeLinks=function(){for(var _this=this,i=0,len=_this.sections.length;i<len;i++)$(_this.sections[i].menuItem).removeClass(_this.opts.activeClass)},setActiveLink=function(){var curr,next,prev,_this=this;return _this.currentSection===undefined?void removeLinks.call(_this):(curr=_this.sections[this.currentSection],prev=_this.sections[_this.currentSection-1],next=_this.sections[_this.currentSection+1],prev&&$(prev.menuItem).removeClass(_this.opts.activeClass),next&&$(next.menuItem).removeClass(_this.opts.activeClass),void $(curr.menuItem).addClass(_this.opts.activeClass))};Plugin.prototype={init:function(){var resizeTimer,_this=this;"function"==typeof _this.cb.onInitBefore&&_this.cb.onInitBefore(),getAllSections.call(_this),setCurrentSection.call(_this,$(window).scrollTop()),setActiveLink.call(_this),$(window).scroll(function(){setCurrentSection.call(_this,$(window).scrollTop()),setActiveLink.call(_this)}),$(window).resize(function(e){clearTimeout(resizeTimer),resizeTimer=setTimeout(function(){getAllSections.call(_this),setCurrentSection.call(_this,$(window).scrollTop()),setActiveLink.call(_this)},250)}),"function"==typeof _this.cb.onInitAfter&&_this.cb.onInitAfter()},getCurrentSection:function(){return this.currentSection}},window[PLUGIN_NS]=Plugin}(jQuery||Zepto,window,document);