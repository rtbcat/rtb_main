UniBPMixPanel=Class.create(),UniBPMixPanel.prototype={initialize:function(config){var me=this;me.defaultProperties={Domain:window.location.hostname,Current:window.location.href},config&&config.properties&&Object.extend(me.defaultProperties,config.properties),me.getRegion=this.getRegion.bind(me),me.getPayment=this.getPayment.bind(me)},autoTrackEvents:function(elements){var me=this;jQuery(elements).on("click",function(){var eventName=jQuery(this).data("mixpanel");eventName.length>0&&me.track(eventName)})},autoTrackRedirects:function(elements){var me=this;jQuery(elements).each(function(){var eventName=jQuery(this).data("mixpanel-redirect");if(eventName){var selector="mixpanel-"+Math.floor(65536*(1+Math.random())).toString(16).substring(1);jQuery(this).addClass(selector),me.trackLinks("."+selector,eventName)}})},autoTrackForms:function(elements){var me=this;jQuery(elements).each(function(){var eventName=jQuery(this).data("mixpanel-form");if(eventName){var selector="mixpanel-form-"+Math.floor(65536*(1+Math.random())).toString(16).substring(1);jQuery(this).closest("form").addClass(selector),jQuery("form."+selector).on("submit",function(e){var formToValidate=$$("form."+selector)[0],validator=new Validation(formToValidate);validator.validate()&&!formToValidate.classList.contains("newCheckout")?me.track(eventName,{},function(){jQuery(this).submit()}):(me.track(eventName),e.preventDefault())})}})},autoTrackPages:function(elements){var me=this;jQuery(elements).each(function(){var eventName=jQuery(this).data("mixpanel-page");eventName&&me.track(eventName)})},autoTrackChechBox:function(elements){var me=this;jQuery(elements).on("change",function(){var eventNameChecked=jQuery(this).data("mixpanel-checked"),eventNameUnChecked=jQuery(this).data("mixpanel-unchecked");(eventNameChecked||eventNameUnChecked)&&(jQuery(this).prop("checked")?me.track(eventNameChecked):me.track(eventNameUnChecked))})},track:function(eventName,properties,callback){properties=this._mergeProperties(properties),mixpanel&&"function"==typeof mixpanel.track&&mixpanel.track(eventName,properties,callback)},trackForm:function(selector,eventName,properties){properties=this._mergeProperties(properties),mixpanel&&"function"==typeof mixpanel.track_forms&&$$(selector)&&mixpanel.track_forms(selector,eventName,properties)},trackLinks:function(selector,eventName,properties){properties=this._mergeProperties(properties),mixpanel&&"function"==typeof mixpanel.track_links&&mixpanel.track_links(selector,eventName,properties)},getRegion:function(regionSelect,regionInput){var rObj,region="Undefined";if(regionSelect&&regionInput&&(rObj=$(regionSelect),region=$F(regionInput),rObj&&rObj.selectedIndex&&rObj.options))for(var key in rObj.options)key==rObj.selectedIndex&&(region=rObj.options[rObj.selectedIndex].text);return region},getPayment:function(){var ccsave,account,radio=$$("#aw-onestepcheckout-payment-method input[type=radio]"),paymentName="Undefined";return radio.each(function(item){if(item.checked)if("ccsave"===item.readAttribute("value")){if(paymentName="Credit Card",ccsave=$("ccsave_cc_type"),ccsave&&ccsave.selectedIndex&&ccsave.options)for(var key in ccsave.options)key==ccsave.selectedIndex&&(paymentName+=" "+ccsave.options[ccsave.selectedIndex].text)}else if("achpayments"===item.readAttribute("value")&&(paymentName="eCheck",account=$("achpayments_echeck_holder_type"),account&&account.selectedIndex&&account.options))for(var key in account.options)key==account.selectedIndex&&(paymentName+=" "+account.options[account.selectedIndex].text)}),paymentName},_mergeProperties:function(options){var properties=options||{};return Object.extend(properties,this.defaultProperties),properties},browserDetecter:function(){var version=detect.parse(navigator.userAgent).browser.name;return version}},jQuery(document).ready(function(){var UniBpMixPanel=new UniBPMixPanel;UniBpMixPanel.autoTrackEvents("a.hasevent ,button.hasevent, span.hasevent "),UniBpMixPanel.autoTrackRedirects("a.hasredirect, button.hasredirect"),UniBpMixPanel.autoTrackForms("a.hasform, button.hasform"),UniBpMixPanel.autoTrackPages(".trackpage"),UniBpMixPanel.autoTrackChechBox(".trackcheckbox"),UniBpMixPanel.browserDetecter(),jQuery(".account-create #country ").on("change",function(){mixpanel.register({Location:jQuery(this).find("option:selected").text()},30)}),"undefined"!=typeof product_name&&mixpanel.register({product:product_name},10),"undefined"!==UniBpMixPanel.browserDetecter()&&mixpanel.register({"Browser version":UniBpMixPanel.browserDetecter()},30),jQuery.cookie("transaction_id")?(jQuery.cookie("affiliate_id")?mixpanel.register({affiliate_id:jQuery.cookie("affiliate_id")},30):mixpanel.register({affiliate_id:"none"},30),mixpanel.register({transaction_id:jQuery.cookie("transaction_id")},30)):jQuery.cookie("aid")&&(mixpanel.register({aid:jQuery.cookie("aid")},30),jQuery.cookie("tid")?mixpanel.register({tid:jQuery.cookie("tid")},30):mixpanel.register({tid:"none"},30))});