jQuery(document).ready(function(){var Scorecard=Stapes.subclass({cache_key:'holdings',scorecard_proxy_api_url:'/a/scorecard-user/returns.json?apiKey=public',ttl:15000,constructor:function(){console.log('Fool.User.Scorecard -- starting up...');this.cache=kizzy('fool.scorecard');this.getHoldings();},getHoldings:function(){cachedResult=this.cache.get(this.cache_key);if(cachedResult){console.log('Fool.User.Scorecard -- got from cache');console.log('Fool.User.Scorecard -- ready');return cachedResult;}
if(!this.has('ajax-in-progress')){this.getHoldingsFromAPI();}
return false;},getHoldingsFromAPI:function(){this.set('ajax-in-progress',true,true);jQuery.ajax(this.scorecard_proxy_api_url,{contentType:'application/json',context:this,success:this.setCache});},setCache:function(data){this.remove('ajax-in-progress',true);console.log('Fool.User.Scorecard -- updating cache');this.cache.set(this.cache_key,data,this.ttl);console.log('Fool.User.Scorecard -- ready');this.emit('fool:user:scorecard:holdings.ready',data);}});window.Fool.User.extend({'Scorecard':new Scorecard()});});